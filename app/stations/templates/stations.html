{% extends 'base.html' %} {% block title %} | Map {% endblock %} {% block styles
%}
<link
  rel="stylesheet"
  href="{{ url_for('static',filename='css/stations.css') }}"
/>
{% endblock %}{% block content %}

<div id="map-filters" class="filter-panel">
  <!--left ：Weather and Prediction buttons-->
  <div class="filters-left">
    <button id="weather-btn" title="View Weather">
      <i class="fa-solid fa-cloud-sun"></i>
    </button>
    <button id="prediction-btn-modal" title="Predict Bike Availability">
      <i class="fa-solid fa-bicycle"></i>
    </button>
  </div>

  <!-- Center: Checkboxes -->
  <div class="filters-center checkbox-group">
    <label><input type="checkbox" id="filter-bikes" /> Has Bikes</label>
    <label><input type="checkbox" id="filter-stands" /> Has Stands</label>
    <label><input type="checkbox" id="filter-not-empty" /> Not Empty</label>
    <label><input type="checkbox" id="filter-not-full" /> Not Full</label>
  </div>

  <!-- Right: Search bar -->
  <div class="filters-right search-group">
    <input
      type="text"
      id="station-search"
      placeholder="Search station name..."
    />
    <i class="fa-solid fa-magnifying-glass"></i>
  </div>
</div>

<!-- Loading overlay -->
<div id="loading" class="loading-overlay">
  <div class="loading-spinner"></div>
  <p>Loading stations...</p>
</div>

<!-- Map container -->
<div id="map"></div>

<!-- Prediction Modal -->
<div id="prediction-modal" class="modal">
  <div class="prediction-content">
    <span class="close">&times;</span>
    <div id="prediction-form">
      <h1>Bike Availability Prediction</h1>
      <label for="predict-date">Select Date:</label>
      <input type="date" id="predict-date" required />
      <label for="predict-time">Select Time:</label>
      <input type="time" id="predict-time" required />
      <label for="station_id">Select Station:</label>
      <select id="station_id" required>
        <option value="">-- Select a station --</option>
        <!-- Stations will be populated dynamically -->
      </select>
      <button id="predict-btn">Predict</button>
      <div id="result"></div>
    </div>
  </div>
</div>

<!-- Prediction Sidebar -->
<div id="prediction-sidebar">
  <span class="close-btn" onclick="closePredictionSidebar()">&times;</span>
  <h2>Predicted Bike Availability</h2>
  <p id="prediction-station-name"></p>
  <canvas id="prediction-chart"></canvas>
</div>

<!-- Weather Modal -->
<div id="weather-modal" class="modal">
  <div class="weather-content">
    <span class="close">&times;</span>

    <section id="current-weather">
      <h2>Current Weather</h2>
      <div id="current-weather-info"></div>
    </section>

    <div id="weather-layout">
      <section id="hourly-forecast">
        <h3>Hourly Forecast</h3>
        <canvas id="hourly-temp-chart" height="500"></canvas>
      </section>

      <section id="weather-forecast">
        <h3>8-day Forecast</h3>
        <div id="daily-forecast-grid" class="forecast-grid">
          <!-- forecast cards injected here -->
        </div>
        <h3>Hourly Wind Speed</h3>
        <div id="hourly-timeline" class="hourly-timeline"></div>
      </section>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<!-- 第三方库先引入 -->
<script src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- 使用 ESM 的主入口 -->
<script
  type="module"
  src="{{ url_for('static', filename='js/app.js') }}"
></script>

<!-- Google Maps  -->
<script
  src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&v=weekly&libraries=marker"
  async
  defer
></script>

{% endblock %}
